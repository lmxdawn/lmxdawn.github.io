webpackJsonp([5],{SsuN:function(t,e,a){e=t.exports=a("BkJT")(!0),e.push([t.i,"\n.dialog .el-dialog {\n  margin-top: 3vh !important;\n}\n","",{version:3,sources:["/Users/lk/Project/nihuawocai-admin/src/pages/user_manage/admin/role.vue"],names:[],mappings:";AACA;EACE,2BAA2B;CAC5B",file:"role.vue",sourcesContent:["\n.dialog .el-dialog {\n  margin-top: 3vh !important;\n}\n"],sourceRoot:""}])},WQQx:function(t,e,a){"use strict";function i(t){return Object(u.a)({url:"/admin/role/index",method:"get",params:t})}function r(t){return Object(u.a)({url:"/admin/role/auth",method:"get",params:t})}function s(t){return Object(u.a)({url:"/admin/role/auth",method:"post",data:t})}function o(t){return Object(u.a)({url:"/admin/role/save",method:"post",data:t})}function l(t){return Object(u.a)({url:"/admin/role/edit",method:"post",data:t})}function n(t){return Object(u.a)({url:"/admin/role/delete",method:"post",data:t})}function d(t){a("fx5A")}Object.defineProperty(e,"__esModule",{value:!0});var u=a("Vo7i"),m={data:function(){return{query:{name:"",status:""},list:[],loading:!0,authList:[],defaultProps:{children:"children",label:"title"},authLoading:!1,authFormVisible:!1,authFormData:{role_id:"",auth_rules:[]},authFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},addLoading:!1,addFormVisible:!1,addFormData:{name:"",status:"",remark:"",listorder:999},addFormDataRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},editLoading:!1,editFormVisible:!1,editFormData:{id:"",name:"",status:"",remark:"",listorder:""},editIndex:"",editFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},deleteLoading:!1}},methods:{onSubmit:function(){this.getList()},getList:function(){var t=this;this.loading=!0,i(this.query).then(function(e){t.loading=!1,t.list=e||[]}).catch(function(){t.loading=!1,t.list=[]})},handleDel:function(t,e){var a=this;e.id&&this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){a.deleteLoading=!0,n({id:e.id}).then(function(e){a.deleteLoading=!1,e.errcode?a.$message({message:e.errmsg,type:"error"}):(a.$message({message:"删除成功",type:"success"}),a.list.splice(t,1))}).catch(function(){a.deleteLoading=!1})}).catch(function(){a.$message({type:"info",message:"取消删除"})})},handleAuth:function(t){var e=this;this.authFormVisible=!0,this.authFormData.role_id=t,this.authFormData.auth_rules=[],this.authList=[],r({id:t}).then(function(t){e.authList=t.auth_list||[];var a=t.checked_keys||[];e.$refs.tree.setCheckedKeys(a)}).catch(function(){})},authSubmit:function(){var t=this;if(this.authLoading=!0,this.authFormData.auth_rules=this.$refs.tree.getCheckedKeys(),!this.authFormData)return this.$alert("请至少选择一个权限","提示",{confirmButtonText:"确定"}),!1;s(this.authFormData).then(function(e){t.authLoading=!1,e.errcode?t.$message({message:e.errmsg,type:"error"}):(t.$message({message:"授权成功",type:"success"}),t.authFormVisible=!1)}).catch(function(){t.editLoading=!1})},handleEdit:function(t,e){this.editFormVisible=!0,this.editFormData=Object.assign({},e),this.editFormData.status+="",this.editIndex=t},editSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t){e.editLoading=!0;var a=Object.assign({},e.editFormData);l(a).then(function(t){e.editLoading=!1,t.errcode?e.$message({message:t.errmsg,type:"error"}):(e.$message({message:"编辑成功",type:"success"}),e.$refs.editFormData.resetFields(),e.editFormVisible=!1,e.list.splice(e.editIndex,1,a))}).catch(function(){e.editLoading=!1})}})},handleAdd:function(){this.addFormVisible=!0,this.addFormData={name:"",status:"",remark:"",listorder:999}},addSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t){e.addLoading=!0;o(Object.assign({},e.addFormData)).then(function(t){e.addLoading=!1,t.errcode?e.$message({message:t.errmsg,type:"error"}):(e.$message({message:"添加成功",type:"success"}),e.$refs.addFormData.resetFields(),e.addFormVisible=!1,e.getList())}).catch(function(){e.addLoading=!1})}})}},filters:{statusFilterType:function(t){return{0:"gray",1:"success"}[t]},statusFilterName:function(t){return{0:"禁用",1:"正常"}[t]}},mounted:function(){},created:function(){this.getList()}},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticClass:"query-form",attrs:{inline:!0,model:t.query,size:"mini"}},[a("el-form-item",{staticClass:"query-form-item"},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.query.name,callback:function(e){t.$set(t.query,"name",e)},expression:"query.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"query-form-item"},[a("el-select",{attrs:{placeholder:"状态"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[a("el-option",{attrs:{label:"禁用",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"正常",value:"1"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.getList}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:t.onSubmit}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.handleAdd(e)}}},[t._v("新增")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"max-height":"500"}},[a("el-table-column",{attrs:{label:"角色 ID",prop:"id",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{label:"角色名称",prop:"name",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("statusFilterType")(e.row.status)}},[t._v(t._s(t._f("statusFilterName")(e.row.status)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",with:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t._f("parseTime")(e.row.create_time,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.remark))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"margin-left":"0"},attrs:{size:"small"},nativeOn:{click:function(a){t.handleAuth(e.row.id)}}},[t._v("授权")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"0"},attrs:{size:"small"},nativeOn:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"danger",size:"small",loading:t.deleteLoading},nativeOn:{click:function(a){t.handleDel(e.$index,e.row)}}},[t._v("删除\n                ")])]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"授权",visible:t.authFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.authFormVisible=e}}},[a("el-tree",{ref:"tree",staticStyle:{"max-height":"75vh","overflow-y":"auto"},attrs:{data:t.authList,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:t.defaultProps}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.authFormVisible=!t.authFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.authLoading},nativeOn:{click:function(e){t.authSubmit()}}},[t._v("提交\n            ")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}}},[a("el-form",{ref:"editFormData",attrs:{model:t.editFormData,rules:t.editFormRules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editFormData.name,callback:function(e){t.$set(t.editFormData,"name",e)},expression:"editFormData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"listorder"}},[a("el-input",{attrs:{type:"","auto-complete":"off"},model:{value:t.editFormData.listorder,callback:function(e){t.$set(t.editFormData,"listorder",e)},expression:"editFormData.listorder"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.editFormData.status,callback:function(e){t.$set(t.editFormData,"status",e)},expression:"editFormData.status"}},[a("el-radio",{attrs:{label:"0"}},[t._v("禁用")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("正常")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.editFormData.remark,callback:function(e){t.$set(t.editFormData,"remark",e)},expression:"editFormData.remark"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.editFormVisible=!t.editFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.editLoading},nativeOn:{click:function(e){t.editSubmit("editFormData")}}},[t._v("提交\n            ")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"新增",visible:t.addFormVisible},on:{"update:visible":function(e){t.addFormVisible=e}}},[a("el-form",{ref:"addFormData",attrs:{model:t.addFormData,rules:t.addFormDataRules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.addFormData.name,callback:function(e){t.$set(t.addFormData,"name",e)},expression:"addFormData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"listorder"}},[a("el-input",{attrs:{type:"","auto-complete":"off"},model:{value:t.addFormData.listorder,callback:function(e){t.$set(t.addFormData,"listorder",e)},expression:"addFormData.listorder"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.addFormData.status,callback:function(e){t.$set(t.addFormData,"status",e)},expression:"addFormData.status"}},[a("el-radio",{attrs:{label:"0"}},[t._v("禁用")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("正常")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addFormData.remark,callback:function(e){t.$set(t.addFormData,"remark",e)},expression:"addFormData.remark"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.addFormVisible=!t.addFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.addLoading},nativeOn:{click:function(e){t.addSubmit("addFormData")}}},[t._v("提交")])],1)],1)],1)},f=[],h={render:c,staticRenderFns:f},g=h,p=a("/Xao"),v=d,b=p(m,g,!1,v,null,null);e.default=b.exports},fx5A:function(t,e,a){var i=a("SsuN");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("25862b1c",i,!0)}});
//# sourceMappingURL=5.2eb16b93ed778ec63688.js.map