webpackJsonp([4],{"8Wep":function(t,e,a){var i=a("xAv3");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("FIqI")("48c23e4d",i,!0,{})},"E37/":function(t,e,a){"use strict";function i(t){return Object(s.a)({url:"/admin/auth_rule/index"+l,method:"get",params:t})}function r(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",i="add"===e?"/admin/auth_rule/save"+l:"/admin/auth_rule/edit"+l;return Object(s.a)({url:i,method:a,data:t})}function n(t){return Object(s.a)({url:"/admin/auth_rule/delete"+l,method:"post",data:t})}function o(t){a("8Wep")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("Vo7i"),l=".json",d={id:"",pid:"2",name:"",title:"",status:"1",condition:"",listorder:999},u={data:function(){return{query:{name:"",status:""},mergeList:[],node:null,defaultProps:{children:"children",label:"title"},treeList:[],loading:!0,index:null,formName:null,formMap:{add:"新增",edit:"编辑"},formLoading:!1,formVisible:!1,formData:d,formRules:{name:[{required:!0,message:"请输入规则名",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},pidData:{},deleteLoading:!1}},methods:{renderContent:function(t,e){var a=this,i=e.node,r=e.data;e.store;return t("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[t("span",[t("span",{attrs:{title:r.name}},[i.label])]),t("span",[t("el-button",{style:"font-size: 12px;",attrs:{type:"text"},on:{click:function(){return a.handleForm(i,r,"add")}}},["添加子菜单"]),t("el-button",{style:"font-size: 12px;",attrs:{type:"text"},on:{click:function(){return a.handleForm(i,r,"edit")}}},["编辑"]),t("el-button",{style:"font-size: 12px;",attrs:{type:"text"},on:{click:function(){return a.handleDel(i,r)}}},["删除"])])])},onSubmit:function(){this.getList()},getList:function(){var t=this;this.loading=!0,i(this.query).then(function(e){t.loading=!1,t.mergeList=e.merge_list||[],t.treeList=e.tree_list||[]}).catch(function(){t.loading=!1,t.mergeList=[],t.treeList=[]})},handleForm:function(t,e,a){this.formVisible=!0,this.pidData=e||null,d.pid=e&&parseInt(e.id)||"",this.formData=Object.assign({},d),"edit"===a&&(this.formData=Object.assign({},e),this.node=t),this.formData.pid=this.formData.pid?this.formData.pid:"",this.formData.status+="",this.formName=a,this.$refs.dataForm&&this.$refs.dataForm.clearValidate(),e&&e.id&&(this.index=this.mergeList.findIndex(function(t){return t.id===e.id}))},formSubmit:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){t.formLoading=!0;var a=Object.assign({},t.formData);r(a,t.formName).then(function(e){if(t.formLoading=!1,e.errcode)t.$message({message:e.errmsg,type:"error"});else if(t.$message({message:"操作成功",type:"success"}),t.$refs.dataForm.resetFields(),t.formVisible=!1,"add"===t.formName){var i=e||{};t.pidData?(t.pidData.children||t.$set(t.pidData,"children",[]),t.pidData.children.push(i)):t.mergeList.push(i)}else{var r=t.node.parent,n=r.data.children||r.data,o=n.findIndex(function(t){return t.id===a.id});n.splice(o,1,a)}}).catch(function(){t.formLoading=!1})}})},handleDel:function(t,e){var a=this;if(e.children&&e.children.length>0)return this.$alert("请先删除子节点","提示",{confirmButtonText:"确定"}),!1;e.id&&this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){a.deleteLoading=!0,n({id:e.id}).then(function(i){if(a.deleteLoading=!1,i.errcode)a.$message({message:i.errmsg,type:"error"});else{a.$message({message:"删除成功",type:"success"});var r=t.parent,n=r.data.children||r.data,o=n.findIndex(function(t){return t.id===e.id});n.splice(o,1)}}).catch(function(){a.deleteLoading=!1})}).catch(function(){a.$message({type:"info",message:"取消删除"})})}},filters:{statusFilterType:function(t){return{0:"gray",1:"success"}[t]},statusFilterName:function(t){return{0:"禁用",1:"正常"}[t]}},mounted:function(){},created:function(){this.getList()}},m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticClass:"query-form",attrs:{inline:!0,model:t.query,size:"mini"}},[a("el-form-item",{staticClass:"query-form-item"},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.query.name,callback:function(e){t.$set(t.query,"name",e)},expression:"query.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"query-form-item"},[a("el-select",{attrs:{placeholder:"状态"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[a("el-option",{attrs:{label:"禁用",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"正常",value:"1"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.getList}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:t.onSubmit}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.handleForm(null,null,"add")}}},[t._v("新增")])],1)],1),t._v(" "),a("el-tree",{attrs:{data:t.mergeList,props:t.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"render-content":t.renderContent}}),t._v(" "),a("el-dialog",{attrs:{title:t.formMap[t.formName],visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.formData,rules:t.formRules}},[a("el-form-item",{attrs:{label:"父ID",prop:"pid"}},[a("el-select",{attrs:{placeholder:"顶级"},model:{value:t.formData.pid,callback:function(e){t.$set(t.formData,"pid",e)},expression:"formData.pid"}},t._l(t.treeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}},[a("span",{staticStyle:{float:"left"}},[a("span",{domProps:{innerHTML:t._s(e.html)}}),t._v(t._s(e.title))])])}))],1),t._v(" "),a("el-form-item",{attrs:{label:"规则名",prop:"name"}},[a("el-input",{attrs:{type:"","auto-complete":"off"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规则标题",prop:"title"}},[a("el-input",{attrs:{type:"","auto-complete":"off"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[a("el-radio",{attrs:{label:"0"}},[t._v("禁用")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("正常")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"额外的规则表达式"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.formData.condition,callback:function(e){t.$set(t.formData,"condition",e)},expression:"formData.condition"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"listorder"}},[a("el-input",{attrs:{type:"","auto-complete":"off"},model:{value:t.formData.listorder,callback:function(e){t.$set(t.formData,"listorder",e)},expression:"formData.listorder"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.formVisible=!t.formVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.formLoading},nativeOn:{click:function(e){t.formSubmit()}}},[t._v("提交")])],1)],1)],1)},f=[],c={render:m,staticRenderFns:f},p=c,h=a("Z0/y"),g=o,v=h(u,p,!1,g,null,null);e.default=v.exports},xAv3:function(t,e,a){e=t.exports=a("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"authRule.vue",sourceRoot:""}])}});
//# sourceMappingURL=4.f7e2c848f268d6f8b388.js.map